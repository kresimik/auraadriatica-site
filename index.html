<script>
  async function reloadInfoList(lang) {
    try {
      const curLang = (lang || localStorage.getItem('lang') || 'en').toLowerCase();
      // Radi i kad je site hostan u podmapi (npr. /aura/)
      const url = new URL(`content/${curLang}.json`, document.baseURI).toString();

      const res = await fetch(url, { cache: 'no-store' });
      if (!res.ok) {
        console.warn('Info list fetch failed:', res.status, url);
        return;
      }
      const data = await res.json();

      const list = document.getElementById('info-list');
      if (!list) return;
      list.innerHTML = '';

      if (Array.isArray(data.info_list) && data.info_list.length) {
        data.info_list.forEach(item => {
          const li = document.createElement('li');
          li.textContent = item;
          list.appendChild(li);
        });
      } else {
        console.warn('Missing or empty info_list in', url, data);
        // (opcionalno) prikaži fallback poruku:
        const li = document.createElement('li');
        li.textContent = '—';
        list.appendChild(li);
      }
    } catch (e) {
      console.warn('reloadInfoList error:', e);
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    reloadInfoList(); // initial fill
    document.addEventListener('click', async (e) => {
      const btn = e.target.closest('.lang-menu button[data-lang]');
      if (!btn) return;
      const lang = btn.dataset.lang;
      if (typeof window.setLang === 'function') await window.setLang(lang);
      await reloadInfoList(lang);
    });
  });
</script>
